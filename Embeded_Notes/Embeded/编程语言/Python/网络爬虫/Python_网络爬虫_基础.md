# 爬虫基础
## 爬虫特别关注的请求头和响应头
### 特别关注的请求头字段
![[Pasted image 20210913014021.png]]
http请求形式如图，爬虫特别关注以下几个请求头字段  
+ Content-Type
+ Host(主机和端口号) 域名
+ Connection(链接类型) 长链接
+ Upgrade-Insecure-Requests(升级为HTTPS请求)
+ **User-Agent(浏览器名称)** 用户代理，提供系统信息
+ **Referer(页面跳转处)** 页面跳转处，防盗链
+ **Cookie(Cookie)** 状态保持
+ Authorization(认证信息) 

加粗的请求头为常用请求头，在服务器被用来进行爬虫识别的频率最高，相较于其余的请求头更为重要，但是并不意味着其余的不重要，因为有的网站的韵味或者开发人员可能会不一样，会使用一些不常见的请求头进行爬虫的甄别

### 特别关注的响应头字段
Set-Cookie：对方服务器设置cookie到用户浏览器的缓存

## 常见的状态码
+ 200：成功
+ 302：跳转，新的url在响应的Location头中给出
+ 303：浏览器对于 `POST` 的响应进行重定向至新的url
+ 307：浏览器对于 `GET` 的响应重定向至新的url
+ 403：资源不可用，服务器理解客户的请求，但是拒绝处理它(没有权限) 
+ 404：找不到页面
+ 500：服务器内部错误
+ 503：服务器由于维护或者负载过重未能应答，在响应中可能会携带Retry-After响应头
	+ 有可能是爬虫频繁访问url，使服务器已经识别出是爬虫，但是为了让爬虫使用者疏忽大意，所以照样返回状态码200,但是响应体中并没有数据

**所有的状态码都不可信，一切以是否从抓包得到的响应中获取到数据为准**  
network中抓包得到的源码才是判断依据，`elements` 中的源码是渲染之后的源码，不能作为判断标准

## 浏览器运行的过程
![[Pasted image 20210913021935.png]]
### http请求过程
1. 浏览器在拿到域名对应的ip之后，先向地址栏中的url发起请求，并获取响应
2. 在返回响应内容(html)中，会带有css、js、图片等url地址，以及ajax代码，浏览器按照响应内容中的顺序一次发送其他的请求，并获取相应的响应
3. 浏览器每获取一个响应头，就对展示出的结果进行添加(加载)，js、css等内容会修改页面的内容，js也可以重新发送请求，获取响应
4. 从获取第一个响应并在浏览器中展示，知道最终获取全部响应，并在展示的结果中添加内容或修改——这个过程叫做浏览器的渲染

### 注意
但是在爬虫中，爬虫只会请求url地址，对应的拿到url地址对应的响应(该响应可以是html，css，js，图片等)

浏览器渲染出来的页面和爬虫请求的页面很多时候不一样，是因为爬虫不具有渲染能力(可以利用其他工具或者工具包进行渲染)
+ 浏览器最终展示的结果是由多个url地址分别发送的多次请求对应的多次响应共同渲染的结果
+ 在爬虫中，需要以发送请求的一个url地址对应的响应为准进行数据的提取

