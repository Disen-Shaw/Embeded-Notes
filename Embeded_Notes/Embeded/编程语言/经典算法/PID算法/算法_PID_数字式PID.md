# 数字式PID
计算机控制是一种采样控制，他只能根据采样时刻的偏差计算控制量，**而不能像模拟控制那样连续输出控制量，进行连续控制**
由于这一点，公式中的积分项和微分项不能直接使用，需要经过一定的**离散化处理**
数字式PID算发可以分为**位置式PID**和**增量式PID**
$$u(t)=K_P[e(t)+1/t\int_0^te(t)dt+T_d(de(t)/dt)]$$
+ Kp为控制器的比例系数
+ Ti为控制器的积分时间，Kp/Ti为积分系数Ki
+ Td为控制器的微分时间，Kp×Td为微分系数Kd

## 位置式PID
数字系统中哦个**离散化处理**的方法为：以T为**采样周期**，k作为**采样序号**，则离散采样时间kT对应着**连续时间**t，用**矩形法数值积分**近似代替**积分**，用**一阶后向差分** 近似替代 **微分**，可以做如下近似变换

$t \approx kT(k=0,1,2...)$
$\int_0^te(t)dt \approx T\sum_{j=0}^ke(jT) = T\sum_{j=0}^k e_j$
$de(t)/dt \approx (e(kT)-e[(K-1)T]/T = (e_k - e_{k-1})/T)$

为了表示方便，将e(kT)简化成ek等，将该公式带入之前的模拟PID公式中，就可以得到离散的PID表达式为
$$u_k = Kp[e_k+T/T_i\sum_{j=0}^ke_j+T_d(e_k-e_{k-1})/T]$$
$$u_k = K_p * e_k +K_i\sum_{j=0}^ke_j+K_d(e_k-e_{k-1})$$
其中：
+ k：采样序号，k=0,1,2...
+ $u_k$:第k次采样时刻的计算机输出值
+ $e_k$:第k次采样时刻输入的偏差值
+ $e_{k-1}$第k-1次采样时刻输入的偏差值
+ $K_i$:积分系数，$K_i=K_p*T/T_i$
+ $K_d$:微分系数，$K_d=K_p*T_d/T$

如果采样周期足够小，则数字PID的近似计算可以获得足够精确的结果，离散控制过程与连续过程十分接近
数字PID公式表示的控制算法式直接按模拟PID公式所给出的PID控制规律定义进行计算，所以**给出了全部控制量的大小，因此被称为全量式或者位置式PID控制算法**
这种算法的缺点是：由于全量输出，所以**每次输出都与过去状态有关**，计算时要对ek进行 **累加，工作量很大** ，并且因为计算机输出的uk对于你过的是执行机构的实际位置，如果计算机出现故障，输出的uk将大幅度变化，徽音器执行机构的大幅度变化，有可能因此造成非常严重的事故
因此会对输出结果进行一个限制

**而增量式PID可以避免这两现象发生种**

## 增量式PID
增量式PID指s数字控制器的**输出只是控制量的增量$\Delta uk$**，**当执行机构需要控制量是增量，而不是绝对数值是，可以使用增量式PID控制算法进行控制**
则无好量式PID控制算法可以通过位置式PID公式推导出来。有位置式PID公式可以得到控制器的第k-1个采样时刻的输出值为：

$$u_k = K_p[e_k+T/T_i\sum_{j=0}^ke_j+T_d(e_k-e_{k-1})/T]$$
$$u_{k-1} = K_p[e_{k-1}+T/T_i\sum_{j=0}^{k-1}e_j+T_d(e_{k-1}-e_{k-2})/T]$$

将两个公式相减并整理，就可以得到增量式PID控制算法的公式为：

$$
\begin{equation}\begin{split} 
\Delta u_k &=K_p(e_k-e{k-1}+T/T_ie_k+T_d(e_k-2e_{k-1}+e_{k-2})/T) \\
&=K_p(1+T/T_i+T_d/T)e_k-K_p(1+2Td/T)e_{k-1}+K_pTd/Te_{k-2} \\
&=Ae_k-Be_{k-1}+Ce_{k-2}
\end{split}\end{equation}
$$

其中：
+ A=$K_p(1+T/T_i+T_d/T)$
+ B=$K_p(1+2T_d/T)$
+ C=$K_pT_d/T$

如果计算机控制系统采用**恒定的采样周期T**，一旦确定A、B、C，**只要使用前后三次测量的偏差值**，就可以求出控制量
增量式PID控制算法与位置式PID控制算法公式相比，计算量要小很多，因此在实际中得到广泛的使用
而位置式PID控制算法也可以通过增量式控制算法推出递推计算公式: $u_k = u_{k-1}+\Delta u_k$
