# 控制外设设备
## 驱动程序和应用程序
### 驱动程序
本质：为硬件设备创建对应的设备节点文件
创建设备文件时，规定好文件的使用方式

### 应用程序
根据驱动程序规定的设备文件使用方式去控制硬件

## 控制硬件设备步骤
1. 找出硬件设备对应的设备节点文件
	+ /dev目录下 
	+ `对驱动程序熟悉的工程师可以使用，拥有一个设备节点控制硬件的全部特性`
	+ /sys目录下
	+ 严格地说是Linux内核道出道用户空间的接口
	+ `业余工程师使用，一个设备文件只控制硬件的一个特性`

2. 找出驱动程序规定的设备文件使用方式

## LED灯程序
设备节点文件
`/sys/classs/leds`
往brightness文件写入数值，控制LED的亮度

## 蜂鸣器程序
用GPIO子系统控制
需要手动导出控制蜂鸣器的GPIO操作接口
`引脚GPIO1_19`
`1代表组号，19代表组内引脚编码`

Linux系统引脚编号规则：
(组号-1)×32+组内编码
`1-1×32+19=19`

### 导出GPIO自诩痛硬件操作接口方法
/sys/class/gpio/export
把引脚编号写入进入
gpiox/direction：控制芯片引脚的输入输出模式
in：输入
out：输出
gpiox/value：控制电平
1：高电平
0：低电平

### 检测按键输入
key按键的设备文件
`/dev/input/by-path/platform-gpio-keys-event`
#### input子系统
按键、键盘、鼠标、触摸屏等硬件的抽象
**input_event结构体**
```c
struct input_event{
	struct timeval time;
	__u16 type;
	__u16 code;
	__s32 value;
};
```
+ time：记录输入事件的时间戳
+ type：用来记录输入事件的类型
	+ 按键输入类型
	+ 坐标输入类型
	+ 特殊类型EV_SYN，同步事件
		+ 有一组同步事件发生，提醒我们处理
+ code：记录输入类型的具体事件代号
+ value：记录事件具体值
	+ 比如按键输入事件中
		+ value的值为1代表按下
		+ value的值为0代表松开
