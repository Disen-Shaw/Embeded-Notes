# LiteOS 中断管理 开发流程
## 开发流程
### 配置内核参数
通过 `make menuconfig` 配置中断模块  
配置菜单为：Kernel --> Hardware Interrupt

### 创建中断
调用中断创建接口 `LOS_HwiCreate` 创建中断  

### 设置中断亲和性
如果是 SMP 模式，调用 `LOS_Hwi_SetAffinity` 设置 中断亲和性，如果不是SMP，直接进入下一步

### 使能中断
调用 `LOS_HwiEnable` 接口使能指定中断

### 触发指定中断
调用 `LOS_HwiTrigger` 接口触发指定中断  
该接口通过写中断控制器的相关寄存器模拟外部中断，一般的外设设备不需要执行这一步

### 屏蔽指定中断
可以调用 `LOS_HwiDisable` 接口屏蔽指定中断
根据实际使用，判断是否需要屏蔽中断

### 删除指定中断
调用 `LOS_HwiDelete` 接口删除指定中断  
根据实际使用，判断是否需要删除中断

## 注意事项
+ 根据具体硬件，配置支持的最大中断数和可设置的中断优先级的个数
+ 中断共享机制，支持不同的设备使用相同的中断号注册同一中断处理程序，但中断处理程序的入参 `pDevid`(设备号) 必须为宜，代表不同的设备，即同一中断号同一 `dev` 只能挂载一次;但是同一中断号，同一中断程序 `dev` 不同则可以重复挂载
+ 中断处理程序耗时不能过长，否则会影响CPU对中断的及时响应。
+ 中断响应过程中不能执行引起调度的函数
+ 中断恢复LOS_IntRestore()的入参必须是与之对应的LOS_IntLock()的返回值（即关中断之前的CPSR值）。
+ Cortex-M系列处理器中0-15中断为内部使用，Cortex-A7中0-31中断为内部使用
	+ 因此不建议用户去申请和创建中断