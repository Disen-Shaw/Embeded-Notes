# LiteOS 互斥锁 API
## 使用场景
多任务环境下往往存在多个任务竞争同一临界资源的应用场景，互斥锁可以提供任务间的互斥机制，防止两个任务在同一时刻访问相同的临界资源，从而实现独占式访问

## 互斥锁创建和删除
| 接口名        | 描述           |
| ------------- | -------------- |
| LOS_MuxCreate | 创建互斥锁     |
| LOS_MuxDelete | 删除指定互斥锁 |

## 互斥锁申请和释放
| 接口名      | 描述           |
| ----------- | -------------- |
| LOS_MuxPend | 申请指定互斥锁 |
| LOS_MuxPost | 释放指定互斥锁 | 

## 互斥锁三种模式
+ 无阻塞模式
	+ 即任务申请互斥锁时，入参timeout等于0
	+ 若当前没有任务持有该互斥锁，或者持有该互斥锁的任务和申请该互斥锁的任务为同一个任务，则申请成功，否则立即返回申请失败
+ 永久阻塞模式
	+ 即任务申请互斥锁时，入参timeout等于0xFFFFFFFF
	+ 若当前没有任务持有该互斥锁，则申请成功
	+ 否则，任务进入阻塞态，系统切换到就绪任务中优先级最高者继续执行
	+ 任务进入阻塞态后，直到有其他任务释放该互斥锁，阻塞任务才会重新得以执行
+ 定时阻塞模式
	+ 即任务申请互斥锁时，0<timeout<0xFFFFFFFF
	+ 若当前没有任务持有该互斥锁，则申请成功
	+ 否则该任务进入阻塞态，系统切换到就绪任务中优先级最高者继续执行
	+ 任务进入阻塞态后，超时前如果有其他任务释放该互斥锁，则该任务可成功获取互斥锁继续执行，若超时前未获取到该互斥锁，接口将返回超时错误码

**如果有任务阻塞于该互斥锁，则唤醒被阻塞任务中优先级最高的，该任务进入就绪态，并进行任务调度**  
**如果没有任务阻塞于该互斥锁，则互斥锁释放成功**

## 内核参数
| 配置项                     | 含义                           | 取值范围 | 默认值 | 依赖                |
| -------------------------- | ------------------------------ | -------- | ------ | ------------------- |
| LOSCFG_BASE_IPC_MUX        | 互斥锁模块裁剪开关             | YES/NO   | YES    | 无                  |
| LOSCFG_MUTEX_WAITMODE_PRIO | 互斥锁基于任务优先级的等待模式 | YES/NO   | YES    | LOSCFG_BASE_IPC_MUX |
| LOSCFG_MUTEX_WAITMODE_FIFO | 互斥锁基于FIFO的等待模式       | YES/NO   | NO     | LOSCFG_BASE_IPC_MUX |
| LOSCFG_BASE_IPC_MUX_LIMIT  | 系统支持的最大互斥锁个数       | <65535   | 1024   | LOSCFG_BASE_IPC_MUX | 



如果使用上述API发生错误，参考[[LiteOS_互斥锁管理_错误码]]