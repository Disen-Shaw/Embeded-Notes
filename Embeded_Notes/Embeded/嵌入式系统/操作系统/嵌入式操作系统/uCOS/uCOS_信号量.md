# uCOS信号量
## 信号量
### 信号量概念
信号量像是一种`上锁机制`，**代码必须获得对应的钥匙才能继续执行**，一旦获得了钥匙，也就意味着该任务具有进入被所部分代码的权限。一旦执行至被锁代码段，则任务一直等待，知道对应被所部分的代码的钥匙再次释放才能继续运行。

信号量用于控制对共享资源的保护，但是现在基本用来做`任务同步`。

要想获取资源的任务必须执行“等待”操作，如果该资源对应的信号量有效值大于1,则任务可以获得该资源，任务继续运行。如果该信号量的有效值为0，则任务加入等待信号量的任务表中
如果等待时间超过某一个设定值，该信号量仍然没有被释放掉，则等待信号量的任务就进入就绪态，**如果等待时间设置为0的话任务就将一直等待该信号量**。

### 信号量简介
信号量通常分为两种：`二进制信号量`和`计数型信号量`
二进制信号量只能取0和1两个值，计数型信号量的值大于1，
计数型信号量的范围有`OS_SEM_CTR`决定，`OS_SEM_CTR`可以为8位，16位和32位，取值范围分别为：
+ 8位：0-255
+ 16位：0-65535
+ 32位：0-4294967295

二进制信号量用于那些一次只能一个任务使用的资源，比如I/O设备，打印机计，数型信号量用于某些资源可以同时被几个任务所使用，比如一个缓存池有10个缓存块，那么最多可以支持10个任务来使用内存池

## 信号量API函数
| 函数名             | 作用                   |
| ------------------ | ---------------------- |
| **OSSemCreate() ** | ** 建立一个信号量**    |
| OSSemDel()         | 删除一个信号量         |
| **OSSemPend() **   | **等待一个信号量 **    |
| OSSemPendAbrot()   | 取消等待               |
| **OSSemPost() **     |** 释放或者发出一个信号量** |
| OSSemSet()         | 强制设置一个信号量的值 |

## 使用方法
先定义一个信号量结构体
在开始任务里建立信号量
### 对共享资源的使用
在共享资源处使用之前申请信号量，使用之后释放信号量
申请信号量使用`OSSemPend()`,释放信号量使用`OSSemPost()`

### 任务同步
一个任务发送信号量`OSSemPost()`，另一个任务接收信号量`OSSemPend()`

