# SRAM和SDRAM
## SRAM和SDRAM功能介绍
MCU控制器芯片内部有一定大小的RAM及FLASH作为内存和程序存储空间，但当程序较大的时候，内存和程序空间不足时，就需要在STM32芯片的外部扩展存储器了

扩展内存(RAM)时一般使用SRAM或者SDRAM存储器
要使用这些存储器，需要有对应的控制器产生`控制协议`
以STM32为例：

+ F1系列及F407的芯片上封装了FSMC外设，支持扩展SRAM作为RAM，由于芯片引脚数量的限制，只有STM32F103ZE及以上型号才可以接外部扩展SRAM
+ STM32F429系列以及后续芯片的7系列，则封装了FM外设，支持扩展SDRAM作为RAM

与PC的扩展内存类似，只是PC机上一般是以内存条的形式扩展，内存条实质上是多个内存颗粒(即SDRAM芯片)构成的标准模块，而STM32直接与SRAM、SDRAM芯片连接

### SRAM和SDRAM的一些区别
| 存储介质 | SRAM     | SDRAM    |
| -------- | -------- | -------- |
| **存储结构 **| 锁存起   | 电容     |
| **通讯方式 **| 多用异步 | 同步通讯 |

SRAM和SDRAM器件实现原理上的不同，造就了SRAM和SDRAM芯片同体积下存储容量、控制方式、芯片成本等等方面的差异

## SRAM芯片内部功能框架
![[Pasted image 20210612222207.png]]
### SRAM存储矩阵
![[Pasted image 20210612222400.png]]
SRAN内部包含的存储阵列，可以把它理解成一个表格，数据就在表格上。和表格查找一直，指定一个行地址和一个列地址，就可以精准找到单元格，这个是SRAM芯片的寻址原理。这样的每个单元格被称为单元，而这样的表则称为存储矩阵

**SRAM信号线**

| 信号线     | 类型 | 说明                                                                   |
| ---------- | ---- | ---------------------------------------------------------------------- |
| A0-A18     | I    | 地址输入                                                               |
| I/O0~I/O7  | I    | 数据输入输出信号，低字节                                               |
| I/O8~I/O15 | I/O  | 数据输入输出信号，高字节                                               |
| CS2\CS1#   | I    | 片选信号，CS2高电平有效</br>CS1地点评有效</br>部分芯片只有其中一个引脚 |
| OE#        | I    | 输出使能信号，低电平有效                                               |
| WE#        | I    | 写入时能信号，低电平有效                                               |
| UB#        | I    | 数据掩码信号Upper Byte</br>高字节允许访问，低电平有效                  |
| LB#        | I    | 数据掩码信号Upper Byte</br>低字节允许访问，低电平有效                                                                       |

SRAM的控制比较简单，只要控制信号线使能了访问，从地址线输入要访问的地址，即可从I/O数据线写入或者读出数据

### 地址译码器、列I/O及I/O数据电路
![[Pasted image 20210612222207.png]]
地址译码器将N根地址线转化为2^N根信号线，没跟信号线对应一行或者一列存储单元，通过地址线找到具体的存储单元，实现寻址

### 控制电路
![[Pasted image 20210612222207.png]]
控制电路主要包含了片选、读写时能以及宽度控制信号UB#和LB#
利用CS2或者CS1#片选信号，可以吧多个SRAM芯片组成一个大容量的内存条
OE#和WE#可以控制读写时能，防止误操作

### SRAM的续写流程
查看协议主要查看时序要求
SRAM特点：没有时钟要求，全静态操作
对SRAM进行`读数据`时，它的各个信号线的时序流程如下
![[Pasted image 20210612224622.png]]
对SRAM进行`写数据`时，它的各个信号线的时序流程如下
![[Pasted image 20210613020847.png]]

+ 主机使用地址信号线发出要访问的存储器目标地址
+ 控制片选信号CS#和CS2#使能存储器芯片
+ 若要进行读操作，控制读时能信号OE#表示要读数据
+ 若进行写操作，则控制写使能信号WE#表示要写数据
+ 使用掩码信号LB#与UB#指示要访问目标地址的高、低字节部分
+ 若是读取过程，存储器会通过数据线想主机输出目标数据
+ 若是写入过程，主要使用数据线向存储器传输目标数据

**使用STM32只需要配置好FSMC控制器，FSMC控制器会自动构建数据读取时序，将时序的`关键参数`配置到FSMC控制器中就行**

| Time parameter | IS62WV51216BLL-55ns | explain                |
| -------------- | ------------------- | ---------------------- |
| t_RC           | 55ns                | 读操作周期             |
| t_AA           | 0ns                 | 地址访问时间           |
| t_WC           | 55ns                | 写操作周期             |
| t_SA           | 0ns                 | 地址建立时间           |
| t_SD           | 25ns                | 数据建立到结束时间     |
| t_HD           | 0ns                 | 数据写结束后的保持时间 |

以上参数需要配置给FSMC控制器，就可以对SRAM进行访问
