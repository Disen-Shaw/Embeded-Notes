# AT指令调试
## ESP8266
本身是一个MCU，所以有两种用途：
+ 当成一个普通的 `WiFi模块` ，用官方集成的`AT指令`。
+ 当成一个集成了 `WiFi` 功能的 MCU ，用平台提供的 SDK 进行深度开发。
	+ 本文使用AT，因此MCU的模式不介绍


## 基础指令
| AT指令 | 返回值 | 描述                            |
| ------ | ------ | ------------------------------- |
| AT     | OK     | 测试用的，返回OK证明模块正常    |
| AT+RST | OK     | 重启设备，类似于按下了RST复位键 |


## 配置指令
**设置波特率**

| AT指令              | 返回值 | 描述               |
| ------------------- | ------ | ------------------ |
| AT+CIOBAUD=BaudRate | OK     | 设置波特率的具体值 |

波特率的取值范围可以是：  
`1200、2400、4800、9600、14400、19200、38400、`  
`43000、57600、76800、115200、128000、230400`    
还可以使用自定义的值，但是一般不会用到。

**设置工作方式**  

| AT指令         | 返回值 | 描述               |
| -------------- | ------ | ------------------ |
| AT+CWMODE=MODE | OK     | 设置模块的工作模式 |

有三种工作模式可以使用
+ MODE为1：Station模式(客户端)，模块作为节点，连接其他的 `WiFi`。  
+ MODE为2：AP模式(服务器模式)，模块自身开一个 `WiFi`，可以提供其他模块连接。  
+ MODE为3：混合模式，前面两种使用方式混合使用。  

**设置服务器模式的参数**  

| AT指令                               | 返回值 | 描述             |
| ------------------------------------ | ------ | ---------------- |
| AT+CWSAP="SSID","PASSWD","CHL","ENC" | OK     | 设置服务器的信息 | 

+ SSID：服务器名(WiFi名)
+ PASSWD：服务器密码(WiFi密码)
+ CHL：通道号，可以选择1～14
+ ECN：加密方式
	+ 0：开放模式，不设置密码，即使设置了 `PASSWD`，也没有密码
	+ 1：WEB 加密方式
	+ 2：WPA-PSK 加密方式
	+ 3：WPA2-PSK 加密方式
	+ 4：WPA-WPA2-PSK 加密方式

**设置穿透模式**

| AT指令          | 返回值 | 描述         |
| --------------- | ------ | ------------ |
| AT+CIPMODE=MODE | OK     | 设置穿透模式 |

+ MODE=0：非穿透，缺省模式
+ MODE=1：透明穿透

**设置为服务器**  `未能成功实现`  

| AT指令              | 返回值 | 描述         |
| ------------------- | ------ | ------------ |
| AT+CIPSERVER=1,PORT | OK     | 设置为服务器 |

+ PORT为服务器的端口号，一般设置为8080


**设置为多连接**  

| AT指令                   | 返回值 | 描述   |
| ------------------------ | ------ | ------ |
| AT+CWJAP="SSID","PASSWD" | OK     | 连接AP |


**设置加入与推出AP**  

| AT指令                   | 返回值 | 描述               |
| ------------------------ | ------ | ------------------ |
| AT+CWJAP="SSID","PASSWD" | OK     | 加入其他WiFi       |
| AT+CWQAP                 | OK     | 退出当前连接的WiFi |

**设置发送数据**

|            状态            |         指令         |
|:--------------------------:|:--------------------:|
| 单路连接</br>(AT+CIPMUX=0) |  AT+CIPSEND=Length   |
| 单路连接</br>(AT+CIPMUX=1) | AT+CIPSEND=ID,Length |
	
模块收到指令之后换行返回 `>`   
然后开始接受串口数据，当数据长度满 `Length` 时发送数据  
如果未建立连接或者连接被断开，返回 `ERROR`  
如果数据发送成功，则返回 `SEND OK`，ID为客户端编号

**服务器超时设置**

| AT指令            | 返回值   | 描述                   |
| ----------------- | -------- | ---------------------- |
| AT+CIPSTO=Timeout | 断开时间 | 设置服务器超时断开时间 |

服务器主动断开时间 `0～28899`秒。

## 查询指令

**查询版本信息**

| AT指令 | 返回值   |
| ------ | -------- |
| AT+GMR | 版本信息 | 

**查询可以支持哪些工作模式**

| AT指令      | 返回值         |
| ----------- | -------------- |
| AT+CWMODE=? | 支持的工作模式 | 

**查询当前的工作模式**

| AT指令     | 返回值         |
| ---------- | -------------- |
| AT+CWMODE> | 当前的工作模式 | 

**查询当前AP配置的参数** `2、3模式下`

| AT指令    | 返回值   |
| --------- | -------- |
| AT+CWSAP? | 当前参数 | 

**查询当前连接的AP** `1、3模式下`

| AT指令    | 返回值   |
| --------- | -------- |
| AT+CWJAP? | 当前参数 | 

**查询是否是多连接**

| AT指令     | 返回值   |
| ---------- | -------- |
| AT+CIPMUX? | 当前模式 |


**查询服务器主动断开时间**

| AT指令     | 返回值              |
| ---------- | ------------------- |
| AT+CIPSTO? | 断开时间 (0~28800s) |

**查询是否为穿透**

| AT指令      | 返回值   |
| ----------- | -------- |
| AT+CIPMODE? | 当前模式 | 

**查询本地IP地址**  

| AT指令   | 返回值     |
| -------- | ---------- |
| AT+CIFSR | 当前IP地址 |


