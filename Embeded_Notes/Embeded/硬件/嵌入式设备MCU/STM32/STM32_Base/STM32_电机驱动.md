# STM32电机驱动专题
## 直流无刷电机
人们希望STM32可以方便的调整电机速度，但是STM32的IO接口电压和电流一般都是非常有限的
STM32的电压是3.3V
STM32的电流是8mA

所以为了方便控制电机，可以直接添加一个驱动板电路
驱动板有两种驱动线：电源线和控制信号线

电源输入线一般要求是可以提供电机额定电源的大电流电源，电机的能量来源
控制信号和主控相连

**电机控制都是必须有驱动器的**
![[Pasted image 20210413161735.png]]
电机驱动器：
把小信号放大成大信号

### 直流减速电机驱动器设计
![[Pasted image 20210413162530.png]]
H桥电路，四个开关被称为桥臂

当AD闭合，BC断开，直流电机正常旋转
当BC闭合，AD断开，直流电机反向旋转

当AC闭合，BD断开或者BD闭合，AC断开，点击惯性转动产生的电动势江北短路，形成阻碍运动的饭电动势，形成"刹车作用"
当ABCD都断开，电机处于"惰行"状态，电机随惯性转动

在电路中可以做电子开关的有三极管和MOS管，可以是这两种器件代替开关实现电路可控的效果
![[Pasted image 20210413163320.png]]

结合PWM信号，可以控制电机的转速
改进电路：
![[Pasted image 20210413163642.png]]
增加了四个与门和两个非门
四个与门同一个使能导通信号相连，用一个信号就能控制整个电路的开关
两个非门通过提供一种方向输入，可以保证任何时候在H桥的同策都只有一个三极管导通

电路原件太多，还是推荐使用电机驱动芯片
目前的驱动芯片：L298N、BST7970、MC33886等
选型看三个方面：
+ 驱动的效率转化
	+ 电路本身最好不消耗或者少消耗能量
	+ 四个桥臂在导通时最好没有压降，或者越小越好 
+ 能够通过驱动电流
	+ 电机工作电流不会造成芯片的烧毁
+ 芯片的价格

![[Pasted image 20210413181841.png]]
**GND要连在一起** 


## 编码器
将信号或者数据进行**编制、转换为可以用于通讯、传输和存储的信号**形式的设备，把**角位移**或者**直线位移**转换成**电信号**，再把这个电信号转变成**计数脉冲**，**用脉冲的个数表示位移的大小**
**绝对式编码器**的**每一个位置对应一个确定的数字码**，因此它的示值只与测量的起始和终止位置有关，而与测量的中间过程无关。

![[Pasted image 20210413201936.png]]

由STM32读取这些脉冲，得到电机的转速
### 霍尔传感器
单极性霍尔传感器的感应方式：
磁场的一个磁极靠近它，输出低电位电压(低电平)或有关的信号
磁场的一个磁极离开它，输出高电位电压(高电平)或有关的信号
单极性霍尔开关他会指定某磁极感应才有效，一般书正面感应磁场S极，反面感应N极

双极性霍尔开关的感应方式：磁场有两个磁极N和S，两耳光磁极分别控制霍尔传感器输出高电平、低电平，一般具有锁定作用，磁极离开霍尔输出不发生改变，直到下一个感应生效
双极性霍尔开关的初始状态是随机输出，有可能是高电平，有可能是低电平

全极性霍尔开关的感应方式：
与单极性相似，区别在于单极性霍尔开关会指定磁极，全极性的不会指定，任何磁极靠近输出低电平信号，离开输出高电平信号

![[Pasted image 20210413203211.png]]

霍尔传感器信号
![[Pasted image 20210413203452.png]]






 

