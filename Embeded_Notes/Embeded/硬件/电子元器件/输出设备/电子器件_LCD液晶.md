# LCD液晶
## 简介
显示器是计算机的I/O设备，及输入输出设备，是一种将特定电子信息输出到屏幕上在反射到人眼的现实工具
常见的有CRT显示器，液晶显示器，LED点阵显示器和OLED显示器，液晶显示器，简称LCD(Liquid Crystal Display)，对比于上一代CRT下时期，LCD显示器具有功耗低，体积小、承载信息量大和不伤眼等优点，因此它成为了现代主流的电子现实设备。

### 液晶显示器
液晶是一种介于液体和固体之间的特殊物质，它是一种有机化合物，常态下为液态，但是分子排列却和固态晶体一样非常规则，因此取名为`液晶`
如果给液晶施加电场，会改变它的分子排列，从而改变光线的传播方向，配合偏振片，它就具有控制光线头过率的作用，再配合彩色滤光片，改变液晶电压大小，就能改变某一颜色的透光量的多少

#### LCD结构
![[Pasted image 20210615003432.png]]
通过控制典雅导致液晶的旋转角度不同，控制LCD的明暗变化

利用液晶控制的原理，可做出红绿蓝输出强度的现实结构，把三种显示结构组成一个显示单位，通过控制红绿蓝的强度，可以使该单位混合输出不同的色彩，这样的一个显示单位称为像素

#### OLED的结构
有机自发光二极管,像素密度比普通LED点阵显示器高
![[Pasted image 20210615003701.png]]
OLED没有液晶层与背光层，直接控制发光二极管就可以控制每个像素的不同颜色亮度，混合处需要的颜色

可以控制部分LED的亮灭，LCD一开屏幕整个屏幕就要亮起来
对比度OLED也更有优势
液晶在温度低时响应变慢
厚度更薄

LCD采用DC调光</br>
OLED采用PWM调光

### 像素点的构成
每个像素点有RGB三色点构成
![[Pasted image 20210615003204.png]]
可以通过混合RGB颜色比例来得到想要的任何颜色(基本)
分辨率指的就是像素点的数目


## 显示器控制原理
### 显示器的基本参数
+ 像素
+ 分辨率
+ 色彩深度 单位(位)
	+ RGB565表示R位数为5,G位数位6,B位数为5，一共有2^16种颜色
	+ RGB888表示R位数为8,G位数位8,B位数为8
+ 显示器尺寸 一般以对角线英寸表示
+ 点据 点据越小，画质越细腻

### 显示器接口技术
+ DP、HDMI、DVI、VGA
+ MCU模式，RGB模式、SPI、串口

### 屏幕组成
一个完整的屏幕由三个部分所组成的
+ 液晶显示面板
+ 电容触摸面板
+ PCB底板

### 液晶面板的控制信号
| 信号名称 | 说明                                       |
| -------- | ------------------------------------------ |
| R\[7:0]  | 红色数据                                   |
| G\[7:0]  | 绿色数据                                   |
| B\[7:0]  | 蓝色数据                                   |
| CLK      | 像素同步时钟信号                           |
| HSYNC    | 水平同步信号，每传输一行，就会发生一次跳变 |
| VSYNC    | 垂直同步信号，跳变次数和帧率相等           | 
| DE       | 数据使能信号，使能之后RGB信号才有效                               |

### 液晶数据传输时序
通过信号线想液晶屏传输像素数据时，各信号线时序：
![[Pasted image 20210615011020.png]]
每个像素由一个时钟周期进行配置

### 液晶数据传输时序参数
液晶显示指针在行与行之间，帧与帧之间切换时需要延时，而且`HSYNC`和`VSYNC`信号本身也有宽度

| 时间参数                    | 参数说明                                            |
| --------------------------- | --------------------------------------------------- |
| VBP(vertical back porch)    | 在一帧图像开始时，垂直同步信号以后的无效行数        |
| VFP(vertical front porch)   | 在一帧图像结束后，垂直同步信号以前的无效行数        |
| HBP(horizontal back porch)  | 从水平同步信号到下一行的有效数据开始之间的CLK的个数 |
| HFP(horizontal front porth) | 一行的有效数据结束到下一个水平信号开始之间的CLK个数 |
| VSW(vertical sync width)    | 垂直同步信号的宽度，单位为行                        |
| HSW(horizontal sync width)  | 水平同步信号的宽度，单位为同步时钟CLK的个数         |

由`LCD控制芯片`产生，不要 `STM32` 或者 `其他主控` 考虑控制

### 显存
液晶屏中的每个像素点都是数据  
在实际应用中需要把每个像素点的数据缓存起来，再传输给液晶屏，这种存储显示数据的存储器被称为`显存`  
**显存一般至少能存储液晶屏一帧的显示数据**

`比如分辨率为800x400的液晶屏`  
`使用格式RGB888格式显示，它的一阵显示数据大小为3x800x400=1152000字节`  
`使用格式RGB565格式显示，它的一阵显示数据大小为2x800x400=768000字节`


### ～液晶屏的信号线与8080时序
`ILI9341` 控制器根据自身的IM\[3:0]信号线点评决定它与MCU的通讯方式，它本身支持SPI和8080通讯方式

| 信号线        | ILI9341对应的信号线 | 说明                                                                                |
| ------------- | ------------------- | ----------------------------------------------------------------------------------- |
| LCD_DB\[15:0] | D\[15:0]            | 数据信号                                                                            |
| LCD_RD        | RDX                 | 读数据信号，地电平有效                                                              |
| LCD_RS        | D/CX                | 数据/命令信号，高电平时，数据信号表示的数据;</br>低电平时，数据信号表示的是控制命令 |
| LCD_RESET     | RESX                | 复位信号，低电平有效                                                                |
| LCD_WR        | WRX                 | 写数据信号，低电平有效                                                              |
| LCD_CS        | CSX                 | 片选信号，低电平有效                                                                |
| LCD_BK        | -                   | 背光信号，低电平不亮                                                                |
| GPIO\[5:1]    | -                   | 触摸屏的控制信号线                                                                                    |

### FSMC与LCD
控制LCD时，适合使用FSMC的NOR\\PSRAM模式，它与之前使用到的SRAM有些不同，控制SRAM时使用的是模式A，控制LCD时使用的是NorFLASH一样的模式B

| FSMC信号名称 | 信号方向  | 功能                         |
| ------------ | --------- | ---------------------------- |
| CLK          | 输出      | 时钟(同步突发模式)           |
| A\[25:0]     | 输出      | 地址总线                     |
| D\[15:0]     | 输入/输出 | 双向数据总线                 |
| NE\[x]       | 输出      | 片选，x=1...4                |
| NOE          | 输出      | 输出使能                     |
| NWE          | 输出      | 写使能                       |
| NWAIT        | 输入      | NOR闪存要求FSMC等待的信号    |
| NADV         | 输出      | 地址、数据线复用时作锁存信号 |

在控制LCD时，使用的是类似一部、地址与数据线独立的Nor FLASH控制方式，所以实际上CLK、NWAIT、NADV引脚没有使用到


液晶屏初始化尽量放在串口初始化之前 

