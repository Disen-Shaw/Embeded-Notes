# 内存分区模型

[[../../C语言/c语言内存管理]]

C++程序在执行时，将内存条的存储空间\\
大方向划分为4个区域

- 代码区：存放函数体的二进制代码，由操作系统进行管理
- 全局区：存放全局变量和静态变量以及常量
- 栈区：由编译器自动分配和释放，存放函数的参数值，局部变量等
- 堆区：由程序员分配和释放，若程序员不释放，则由操作系统自动回收

**内存四个区的意义**

不同区域存放的数据，赋予不同的生命周期

## 程序运行前

生成可执行程序\
未执行改程序前分为两个区域

- **代码区**

  存放CPU执行的指令\
  **代码区是共享的**，对于频繁执行的程序，只需要在内存中由一份代码即可

  **代码区是只读的**，防止程序意外修改指令

- **全局区**

  **全局变量**和**静态变量**存放在此

  包含了**常量区**，**字符串常量**和**其他常量(const)**也存放在此

  **数据在程序结束后由操作系统释放**

## 程序运行后

- **栈区**

  由编译器自动分配释放，存放函数的参数、局部变量

  不可以返回局部变量的地址\
  栈区开辟的数据由编译器自动释放

- 堆区

  程序员自己分配释放，若程序员不释放，程序结束时由操作系统回收

  在C++中主要靠new在堆区开辟内存

```c++
int *fun()
{
	int *a = new int(10);   
    // 类似于malloc函数，但还是有些区别
}
```
